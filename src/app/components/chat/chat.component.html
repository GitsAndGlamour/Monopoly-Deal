<mat-accordion class="mat-elevation-z6">
    <mat-expansion-panel id="container">
        <mat-expansion-panel-header id="container-header" class="flex-row flex-space-between">
            <mat-panel-title>
                <mat-icon color="primary">chat</mat-icon>
                &nbsp;
                Chat
            </mat-panel-title>
        </mat-expansion-panel-header>
        <mat-drawer-container autosize>
            <span class="flex-row flex-space-between">
                <h5>&nbsp; {{selected?.name}} Chat!</h5>
                <button mat-button (click)="drawer.toggle()">
                    <mat-icon>{{drawer.opened ? 'keyboard_arrow_right' : 'menu_open'}}</mat-icon>
                </button>
            </span>
            <div #chatWindow id="chat-window">
                <div>
                    <ng-container *ngFor="let message of selected?.messages">
                        <p *ngIf="message"><b>{{message?.from?.displayName}}: </b>{{message?.value}}
                            <br>
                            <small class="timestamp">{{getDate(message?.sent) | date:'short'}}</small>
                        </p>
                    </ng-container>
                </div>
            </div>
            <mat-drawer #drawer id="chat-list" position="end" mode="side">
                <mat-accordion>
                    <mat-expansion-panel hideToggle>
                        <mat-expansion-panel-header (click)="select(lobby)">
                            <mat-panel-title>Lobby</mat-panel-title>
                        </mat-expansion-panel-header>
                    </mat-expansion-panel>
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>Games</mat-panel-title>
                        </mat-expansion-panel-header>
                        <div id="games-list">
                            <mat-button-toggle-group vertical class="full-width">
                                <mat-button-toggle *ngFor="let chat of games" (click)="select(chat)">{{chat.game.name}}</mat-button-toggle>
                                <mat-button-toggle disabled *ngIf="!games.length">No active games</mat-button-toggle>
                            </mat-button-toggle-group>
                        </div>
                    </mat-expansion-panel>
                    <mat-expansion-panel>
                        <mat-expansion-panel-header>
                            <mat-panel-title>Rooms</mat-panel-title>
                        </mat-expansion-panel-header>
                        <div id="rooms-list">
                            <mat-button-toggle-group vertical class="full-width">
                                <mat-button-toggle *ngFor="let chat of rooms" (click)="select(chat)">{{chat.room.name}}</mat-button-toggle>
                                <mat-button-toggle disabled *ngIf="!rooms.length">No open rooms</mat-button-toggle>
                            </mat-button-toggle-group>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </mat-drawer>
        </mat-drawer-container>
        <div id="message-bar" class="flex-row">
            <mat-form-field class="full-width baseline-middle">
                <input matInput placeholder="Send a message..." [formControl]="messageCtrl" (keypress)="onKeyPress($event)">
            </mat-form-field>
            <div><button mat-raised-button color="warn" (click)="send()">Send</button></div>
        </div>
    </mat-expansion-panel>
</mat-accordion>
